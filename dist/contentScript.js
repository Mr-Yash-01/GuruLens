(()=>{"use strict";let e=null;function t(t,n=[{word:"Loading...",phonetics:[{text:"None",audio:""}],meanings:[{definitions:[{definition:"No meaning found"}]}]}]){const o=document.createElement("div");o.style.position="absolute",o.style.left=(t.left-90>16?t.left-90:10)+"px",o.style.top=(t.top-150>16?t.top-150:10)+"px",o.style.backgroundColor="rgba(0, 0, 0)",o.style.color="white",o.style.padding="10px",o.style.borderRadius="8px",o.style.zIndex="9999",o.style.width="300px",o.style.maxWidth="350px",o.style.boxShadow="0 4px 6px rgba(0, 0, 0, 0.1)";const i=document.createElement("div");i.style.display="flex",i.style.justifyContent="space-between",i.style.alignItems="center";const s=document.createElement("span");s.textContent=n[0].word||"Loading...",s.style.fontSize="16px",s.style.fontWeight="bold";const l=document.createElement("span");l.textContent="Ã—",l.style.fontSize="20px",l.style.cursor="pointer",l.style.color="white",l.addEventListener("click",(t=>{t.stopPropagation(),o.remove(),e=null})),i.appendChild(s),i.appendChild(l);const a=document.createElement("div");a.style.display="flex",a.style.justifyContent="space-between",a.style.alignItems="center",a.style.marginTop="10px";const d=document.createElement("span");if(d.textContent=n[0].phonetics&&n[0].phonetics[0]&&n[0].phonetics[0].text||"None",d.style.fontSize="14px",d.style.color="#ddd",a.appendChild(d),n[0].phonetics&&n[0].phonetics[0]&&n[0].phonetics[0].audio){const e=document.createElement("button");e.textContent="ðŸ”Š",e.style.fontSize="18px",e.style.cursor="pointer",e.style.border="none",e.style.background="transparent",e.style.padding="0",e.style.outline="none",e.setAttribute("aria-label","Play pronunciation"),e.addEventListener("click",(e=>{e.stopPropagation(),n[0].phonetics&&n[0].phonetics[0]&&n[0].phonetics[0].audio?new Audio(n[0].phonetics[0].audio).play().catch((e=>{console.error("Error playing audio:",e)})):console.warn("Audio not available for pronunciation.")})),a.appendChild(e)}const r=document.createElement("div");r.style.marginTop="10px";const c=document.createElement("p");c.textContent=n[0].meanings&&n[0].meanings[0].definitions[0].definition||"No meaning found",c.style.fontSize="16px",c.style.color="#ddd",c.style.lineHeight="1.7",r.appendChild(c),o.appendChild(i),o.appendChild(a),o.appendChild(r),document.body.appendChild(o),e=o}document.addEventListener("mouseup",(()=>{let n;const o=(n=window.getSelection())?n.toString().trim():null;if(console.log("Selected Text:",o),o){let i={top:0,left:0};if(n){const e=n.getRangeAt(0).getBoundingClientRect();i={top:e.top+window.scrollY,left:e.left+window.scrollX}}console.log("Sending selected text to background script..."),chrome.runtime.sendMessage({action:"EXPLAIN_TEXT",selection:o,position:i},(n=>{if(console.log("Received response from background script:",n.data),chrome.runtime.lastError)console.error("Error sending message:",chrome.runtime.lastError);else if(n)if(n.action)switch(n.action){case"IGNORE":break;case"RESULT":chrome.runtime.sendMessage({type:"SHOW_POPUP",data:n.data,position:i}),e&&e.remove(),t(i,n.data);break;case"ERROR":e&&e.remove();const o=n.data&&n.data[0]?[{word:n.data[0].word,phonetics:[{text:"none"}],meanings:[{definitions:[{definition:"No matching Found"}]}]}]:[{word:"Unknown",phonetics:[{text:"none"}],meanings:[{definitions:[{definition:"No matching Found"}]}]}];t(i,o);break;default:console.error("Unexpected response action:",n.action)}else console.error("Unexpected response format:",n);else console.error("No response from background script")}))}else console.log("No text selected."),e&&(e.remove(),e=null)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGVudFNjcmlwdC5qcyIsIm1hcHBpbmdzIjoiQUFBQSxNQUNJLGFBRUEsSUFBSUEsRUFBaUIsS0F3RXJCLFNBQVNDLEVBQWVDLEVBQVVDLEVBQU8sQ0FBQyxDQUFFQyxLQUFNLGFBQWNDLFVBQVcsQ0FBQyxDQUFFQyxLQUFNLE9BQVFDLE1BQU8sS0FBT0MsU0FBVSxDQUFDLENBQUVDLFlBQWEsQ0FBQyxDQUFFQyxXQUFZLDBCQUUvSSxNQUFNQyxFQUFVQyxTQUFTQyxjQUFjLE9BQ3ZDRixFQUFRRyxNQUFNWixTQUFXLFdBQ3pCUyxFQUFRRyxNQUFNQyxNQUFVYixFQUFTYSxLQUFPLEdBQUssR0FBS2IsRUFBU2EsS0FBTyxHQUFLLElBQWxELEtBQ3JCSixFQUFRRyxNQUFNRSxLQUFTZCxFQUFTYyxJQUFNLElBQU0sR0FBS2QsRUFBU2MsSUFBTSxJQUFNLElBQWxELEtBQ3BCTCxFQUFRRyxNQUFNRyxnQkFBa0IsZ0JBQ2hDTixFQUFRRyxNQUFNSSxNQUFRLFFBQ3RCUCxFQUFRRyxNQUFNSyxRQUFVLE9BQ3hCUixFQUFRRyxNQUFNTSxhQUFlLE1BQzdCVCxFQUFRRyxNQUFNTyxPQUFTLE9BQ3ZCVixFQUFRRyxNQUFNUSxNQUFRLFFBQ3RCWCxFQUFRRyxNQUFNUyxTQUFXLFFBQ3pCWixFQUFRRyxNQUFNVSxVQUFZLCtCQUcxQixNQUFNQyxFQUFPYixTQUFTQyxjQUFjLE9BQ3BDWSxFQUFLWCxNQUFNWSxRQUFVLE9BQ3JCRCxFQUFLWCxNQUFNYSxlQUFpQixnQkFDNUJGLEVBQUtYLE1BQU1jLFdBQWEsU0FFeEIsTUFBTXhCLEVBQU9RLFNBQVNDLGNBQWMsUUFDcENULEVBQUt5QixZQUFjMUIsRUFBSyxHQUFHQyxNQUFRLGFBQ25DQSxFQUFLVSxNQUFNZ0IsU0FBVyxPQUN0QjFCLEVBQUtVLE1BQU1pQixXQUFhLE9BRXhCLE1BQU1DLEVBQVlwQixTQUFTQyxjQUFjLFFBQ3pDbUIsRUFBVUgsWUFBYyxJQUN4QkcsRUFBVWxCLE1BQU1nQixTQUFXLE9BQzNCRSxFQUFVbEIsTUFBTW1CLE9BQVMsVUFDekJELEVBQVVsQixNQUFNSSxNQUFRLFFBQ3hCYyxFQUFVRSxpQkFBaUIsU0FBVUMsSUFDakNBLEVBQU1DLGtCQUNOekIsRUFBUTBCLFNBQ1JyQyxFQUFpQixJQUFJLElBR3pCeUIsRUFBS2EsWUFBWWxDLEdBQ2pCcUIsRUFBS2EsWUFBWU4sR0FHakIsTUFBTU8sRUFBTzNCLFNBQVNDLGNBQWMsT0FDcEMwQixFQUFLekIsTUFBTVksUUFBVSxPQUNyQmEsRUFBS3pCLE1BQU1hLGVBQWlCLGdCQUM1QlksRUFBS3pCLE1BQU1jLFdBQWEsU0FDeEJXLEVBQUt6QixNQUFNMEIsVUFBWSxPQUV2QixNQUFNQyxFQUFXN0IsU0FBU0MsY0FBYyxRQU94QyxHQU5BNEIsRUFBU1osWUFBZTFCLEVBQUssR0FBR0UsV0FBYUYsRUFBSyxHQUFHRSxVQUFVLElBQU1GLEVBQUssR0FBR0UsVUFBVSxHQUFHQyxNQUFTLE9BQ25HbUMsRUFBUzNCLE1BQU1nQixTQUFXLE9BQzFCVyxFQUFTM0IsTUFBTUksTUFBUSxPQUV2QnFCLEVBQUtELFlBQVlHLEdBRWJ0QyxFQUFLLEdBQUdFLFdBQWFGLEVBQUssR0FBR0UsVUFBVSxJQUFNRixFQUFLLEdBQUdFLFVBQVUsR0FBR0UsTUFBTyxDQUN6RSxNQUFNbUMsRUFBZ0I5QixTQUFTQyxjQUFjLFVBQzdDNkIsRUFBY2IsWUFBYyxLQUM1QmEsRUFBYzVCLE1BQU1nQixTQUFXLE9BQy9CWSxFQUFjNUIsTUFBTW1CLE9BQVMsVUFDN0JTLEVBQWM1QixNQUFNNkIsT0FBUyxPQUM3QkQsRUFBYzVCLE1BQU04QixXQUFhLGNBQ2pDRixFQUFjNUIsTUFBTUssUUFBVSxJQUM5QnVCLEVBQWM1QixNQUFNK0IsUUFBVSxPQUM5QkgsRUFBY0ksYUFBYSxhQUFjLHNCQUV6Q0osRUFBY1IsaUJBQWlCLFNBQVVDLElBQ3JDQSxFQUFNQyxrQkFDRmpDLEVBQUssR0FBR0UsV0FBYUYsRUFBSyxHQUFHRSxVQUFVLElBQU1GLEVBQUssR0FBR0UsVUFBVSxHQUFHRSxNQUNwRCxJQUFJd0MsTUFBTTVDLEVBQUssR0FBR0UsVUFBVSxHQUFHRSxPQUN2Q3lDLE9BQU9DLE9BQU9DLElBQ2hCQyxRQUFRRCxNQUFNLHVCQUF3QkEsRUFBTSxJQUdoREMsUUFBUUMsS0FBSyx5Q0FDakIsSUFHSmIsRUFBS0QsWUFBWUksRUFDckIsQ0FHQSxNQUFNVyxFQUFPekMsU0FBU0MsY0FBYyxPQUNwQ3dDLEVBQUt2QyxNQUFNMEIsVUFBWSxPQUN2QixNQUFNYyxFQUFVMUMsU0FBU0MsY0FBYyxLQUN2Q3lDLEVBQVF6QixZQUFlMUIsRUFBSyxHQUFHSyxVQUFZTCxFQUFLLEdBQUdLLFNBQVMsR0FBR0MsWUFBWSxHQUFHQyxZQUFlLG1CQUM3RjRDLEVBQVF4QyxNQUFNZ0IsU0FBVyxPQUN6QndCLEVBQVF4QyxNQUFNSSxNQUFRLE9BQ3RCb0MsRUFBUXhDLE1BQU15QyxXQUFhLE1BRTNCRixFQUFLZixZQUFZZ0IsR0FHakIzQyxFQUFRMkIsWUFBWWIsR0FDcEJkLEVBQVEyQixZQUFZQyxHQUNwQjVCLEVBQVEyQixZQUFZZSxHQUdwQnpDLFNBQVM0QyxLQUFLbEIsWUFBWTNCLEdBRzFCWCxFQUFpQlcsQ0FDckIsQ0EzS0FDLFNBQVNzQixpQkFBaUIsV0FBVyxLQUNqQyxJQUFJdUIsRUFDSixNQUFNQyxHQUFnQkQsRUFBWUUsT0FBT0MsZ0JBQWtCSCxFQUFVSSxXQUFXQyxPQUFTLEtBR3pGLEdBRkFYLFFBQVFZLElBQUksaUJBQWtCTCxHQUUxQkEsRUFBYyxDQUNkLElBQUl4RCxFQUFXLENBQUVjLElBQUssRUFBR0QsS0FBTSxHQUMvQixHQUFJMEMsRUFBVyxDQUNYLE1BQ01PLEVBRFFQLEVBQVVRLFdBQVcsR0FDaEJDLHdCQUNuQmhFLEVBQVcsQ0FDUGMsSUFBS2dELEVBQUtoRCxJQUFNMkMsT0FBT1EsUUFDdkJwRCxLQUFNaUQsRUFBS2pELEtBQU80QyxPQUFPUyxRQUVqQyxDQUVBakIsUUFBUVksSUFBSSxpREFDWk0sT0FBT0MsUUFBUUMsWUFBWSxDQUFFQyxPQUFRLGVBQWdCZixVQUFXQyxFQUFjeEQsU0FBVUEsSUFBYXVFLElBR2pHLEdBRkF0QixRQUFRWSxJQUFJLDRDQUE2Q1UsRUFBU3RFLE1BRTlEa0UsT0FBT0MsUUFBUUksVUFDZnZCLFFBQVFELE1BQU0seUJBQTBCbUIsT0FBT0MsUUFBUUksZ0JBSTNELEdBQUtELEVBS0wsR0FBS0EsRUFBU0QsT0FLZCxPQUFRQyxFQUFTRCxRQUNiLElBQUssU0FDRCxNQUNKLElBQUssU0FDREgsT0FBT0MsUUFBUUMsWUFBWSxDQUFFSSxLQUFNLGFBQWN4RSxLQUFNc0UsRUFBU3RFLEtBQU1ELFNBQVVBLElBRTVFRixHQUNBQSxFQUFlcUMsU0FHbkJwQyxFQUFlQyxFQUFVdUUsRUFBU3RFLE1BQ2xDLE1BQ0osSUFBSyxRQUNHSCxHQUNBQSxFQUFlcUMsU0FHbkIsTUFBTXVDLEVBQWlCSCxFQUFTdEUsTUFBUXNFLEVBQVN0RSxLQUFLLEdBQUssQ0FBQyxDQUFFQyxLQUFNcUUsRUFBU3RFLEtBQUssR0FBR0MsS0FBTUMsVUFBVyxDQUFDLENBQUVDLEtBQU0sU0FBV0UsU0FBVSxDQUFDLENBQUVDLFlBQWEsQ0FBQyxDQUFFQyxXQUFZLDBCQUErQixDQUFDLENBQUVOLEtBQU0sVUFBV0MsVUFBVyxDQUFDLENBQUVDLEtBQU0sU0FBV0UsU0FBVSxDQUFDLENBQUVDLFlBQWEsQ0FBQyxDQUFFQyxXQUFZLDBCQUM5UlQsRUFBZUMsRUFBVTBFLEdBQ3pCLE1BQ0osUUFDSXpCLFFBQVFELE1BQU0sOEJBQStCdUIsRUFBU0QsYUF6QjFEckIsUUFBUUQsTUFBTSw4QkFBK0J1QixRQUw3Q3RCLFFBQVFELE1BQU0scUNBK0JsQixHQUVSLE1BQ0lDLFFBQVFZLElBQUkscUJBRVIvRCxJQUNBQSxFQUFlcUMsU0FDZnJDLEVBQWlCLEtBRXpCLEdBMEdQLEVBakxEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ3VydWxlbnMvLi9zcmMvY29udGVudFNjcmlwdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIoKCkgPT4ge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgbGV0IGN1cnJlbnRPdmVybGF5ID0gbnVsbDsgIC8vIFRyYWNrIHRoZSBjdXJyZW50bHkgZGlzcGxheWVkIG92ZXJsYXlcclxuXHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCAoKSA9PiB7XHJcbiAgICAgICAgbGV0IHNlbGVjdGlvbjtcclxuICAgICAgICBjb25zdCBzZWxlY3RlZFRleHQgPSAoc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpKSA/IHNlbGVjdGlvbi50b1N0cmluZygpLnRyaW0oKSA6IG51bGw7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJTZWxlY3RlZCBUZXh0OlwiLCBzZWxlY3RlZFRleHQpO1xyXG5cclxuICAgICAgICBpZiAoc2VsZWN0ZWRUZXh0KSB7XHJcbiAgICAgICAgICAgIGxldCBwb3NpdGlvbiA9IHsgdG9wOiAwLCBsZWZ0OiAwIH07XHJcbiAgICAgICAgICAgIGlmIChzZWxlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlID0gc2VsZWN0aW9uLmdldFJhbmdlQXQoMCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZWN0ID0gcmFuZ2UuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0b3A6IHJlY3QudG9wICsgd2luZG93LnNjcm9sbFksXHJcbiAgICAgICAgICAgICAgICAgICAgbGVmdDogcmVjdC5sZWZ0ICsgd2luZG93LnNjcm9sbFgsXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNlbmRpbmcgc2VsZWN0ZWQgdGV4dCB0byBiYWNrZ3JvdW5kIHNjcmlwdC4uLlwiKTtcclxuICAgICAgICAgICAgY2hyb21lLnJ1bnRpbWUuc2VuZE1lc3NhZ2UoeyBhY3Rpb246IFwiRVhQTEFJTl9URVhUXCIsIHNlbGVjdGlvbjogc2VsZWN0ZWRUZXh0LCBwb3NpdGlvbjogcG9zaXRpb24gfSwgKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJlY2VpdmVkIHJlc3BvbnNlIGZyb20gYmFja2dyb3VuZCBzY3JpcHQ6XCIsIHJlc3BvbnNlLmRhdGEpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igc2VuZGluZyBtZXNzYWdlOlwiLCBjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTm8gcmVzcG9uc2UgZnJvbSBiYWNrZ3JvdW5kIHNjcmlwdCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlLmFjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuZXhwZWN0ZWQgcmVzcG9uc2UgZm9ybWF0OicsIHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChyZXNwb25zZS5hY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiSUdOT1JFXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJSRVNVTFRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hyb21lLnJ1bnRpbWUuc2VuZE1lc3NhZ2UoeyB0eXBlOiBcIlNIT1dfUE9QVVBcIiwgZGF0YTogcmVzcG9uc2UuZGF0YSwgcG9zaXRpb246IHBvc2l0aW9uIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGVyZSdzIGFscmVhZHkgYW4gb3ZlcmxheSwgcmVtb3ZlIGl0IGJlZm9yZSBkaXNwbGF5aW5nIHRoZSBuZXcgb25lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50T3ZlcmxheSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudE92ZXJsYXkucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGlzcGxheSB0aGUgb3ZlcmxheSB3aXRoIHRoZSByZXN1bHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU92ZXJsYXkocG9zaXRpb24sIHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiRVJST1JcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRPdmVybGF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50T3ZlcmxheS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEaXNwbGF5IHRoZSBvdmVybGF5IHdpdGggdGhlIHJlc3VsdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub3RGZXRjaGVkRGF0YSA9IHJlc3BvbnNlLmRhdGEgJiYgcmVzcG9uc2UuZGF0YVswXSA/IFt7IHdvcmQ6IHJlc3BvbnNlLmRhdGFbMF0ud29yZCwgcGhvbmV0aWNzOiBbeyB0ZXh0OiBcIm5vbmVcIiB9XSwgbWVhbmluZ3M6IFt7IGRlZmluaXRpb25zOiBbeyBkZWZpbml0aW9uOiBcIk5vIG1hdGNoaW5nIEZvdW5kXCIgfV0gfV0gfV0gOiBbeyB3b3JkOiBcIlVua25vd25cIiwgcGhvbmV0aWNzOiBbeyB0ZXh0OiBcIm5vbmVcIiB9XSwgbWVhbmluZ3M6IFt7IGRlZmluaXRpb25zOiBbeyBkZWZpbml0aW9uOiBcIk5vIG1hdGNoaW5nIEZvdW5kXCIgfV0gfV0gfV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlPdmVybGF5KHBvc2l0aW9uLCBub3RGZXRjaGVkRGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJVbmV4cGVjdGVkIHJlc3BvbnNlIGFjdGlvbjpcIiwgcmVzcG9uc2UuYWN0aW9uKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJObyB0ZXh0IHNlbGVjdGVkLlwiKTtcclxuICAgICAgICAgICAgLy8gQ2xvc2UgdGhlIGN1cnJlbnQgb3ZlcmxheSBpZiBubyB0ZXh0IGlzIHNlbGVjdGVkXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50T3ZlcmxheSkge1xyXG4gICAgICAgICAgICAgICAgY3VycmVudE92ZXJsYXkucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50T3ZlcmxheSA9IG51bGw7ICAvLyBDbGVhciB0aGUgY3VycmVudCBvdmVybGF5IHJlZmVyZW5jZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gRnVuY3Rpb24gdG8gY3JlYXRlIGFuZCBkaXNwbGF5IHRoZSBvdmVybGF5XHJcbiAgICBmdW5jdGlvbiBkaXNwbGF5T3ZlcmxheShwb3NpdGlvbiwgZGF0YSA9IFt7IHdvcmQ6IFwiTG9hZGluZy4uLlwiLCBwaG9uZXRpY3M6IFt7IHRleHQ6IFwiTm9uZVwiLCBhdWRpbzogXCJcIiB9XSwgbWVhbmluZ3M6IFt7IGRlZmluaXRpb25zOiBbeyBkZWZpbml0aW9uOiBcIk5vIG1lYW5pbmcgZm91bmRcIiB9XSB9XSB9XSkge1xyXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgbWFpbiBvdmVybGF5IGRpdlxyXG4gICAgICAgIGNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBvdmVybGF5LnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcclxuICAgICAgICBvdmVybGF5LnN0eWxlLmxlZnQgPSBgJHtwb3NpdGlvbi5sZWZ0IC0gOTAgPiAxNiA/IHBvc2l0aW9uLmxlZnQgLSA5MCA6IDEwfXB4YDsgIC8vIEhvcml6b250YWwgcG9zaXRpb24gb2YgdGhlIHNlbGVjdGlvblxyXG4gICAgICAgIG92ZXJsYXkuc3R5bGUudG9wID0gYCR7cG9zaXRpb24udG9wIC0gMTUwID4gMTYgPyBwb3NpdGlvbi50b3AgLSAxNTAgOiAxMH1weGA7IC8vIFBvc2l0aW9uIGFib3ZlIHRoZSBzZWxlY3Rpb25cclxuICAgICAgICBvdmVybGF5LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2JhKDAsIDAsIDApJztcclxuICAgICAgICBvdmVybGF5LnN0eWxlLmNvbG9yID0gJ3doaXRlJztcclxuICAgICAgICBvdmVybGF5LnN0eWxlLnBhZGRpbmcgPSAnMTBweCc7XHJcbiAgICAgICAgb3ZlcmxheS5zdHlsZS5ib3JkZXJSYWRpdXMgPSAnOHB4JztcclxuICAgICAgICBvdmVybGF5LnN0eWxlLnpJbmRleCA9ICc5OTk5JztcclxuICAgICAgICBvdmVybGF5LnN0eWxlLndpZHRoID0gJzMwMHB4JzsgLy8gU2V0IGEgZml4ZWQgd2lkdGggZm9yIHRoZSBvdmVybGF5XHJcbiAgICAgICAgb3ZlcmxheS5zdHlsZS5tYXhXaWR0aCA9ICczNTBweCc7IC8vIFByZXZlbnQgdGhlIG92ZXJsYXkgZnJvbSBiZWluZyB0b28gd2lkZVxyXG4gICAgICAgIG92ZXJsYXkuc3R5bGUuYm94U2hhZG93ID0gJzAgNHB4IDZweCByZ2JhKDAsIDAsIDAsIDAuMSknO1xyXG5cclxuICAgICAgICAvLyBDcmVhdGUgdGhlIGZpcnN0IHJvdzogU2VsZWN0ZWQgd29yZCArIENsb3NlIGljb25cclxuICAgICAgICBjb25zdCByb3cxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgcm93MS5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xyXG4gICAgICAgIHJvdzEuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnc3BhY2UtYmV0d2Vlbic7XHJcbiAgICAgICAgcm93MS5zdHlsZS5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7XHJcblxyXG4gICAgICAgIGNvbnN0IHdvcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgICAgd29yZC50ZXh0Q29udGVudCA9IGRhdGFbMF0ud29yZCB8fCBcIkxvYWRpbmcuLi5cIjsgIC8vIFRoZSBzZWxlY3RlZCB3b3JkXHJcbiAgICAgICAgd29yZC5zdHlsZS5mb250U2l6ZSA9ICcxNnB4JztcclxuICAgICAgICB3b3JkLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7XHJcblxyXG4gICAgICAgIGNvbnN0IGNsb3NlSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgICBjbG9zZUljb24udGV4dENvbnRlbnQgPSAnw5cnOyAgLy8gQ2xvc2UgaWNvblxyXG4gICAgICAgIGNsb3NlSWNvbi5zdHlsZS5mb250U2l6ZSA9ICcyMHB4JztcclxuICAgICAgICBjbG9zZUljb24uc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xyXG4gICAgICAgIGNsb3NlSWNvbi5zdHlsZS5jb2xvciA9ICd3aGl0ZSc7XHJcbiAgICAgICAgY2xvc2VJY29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOyAgLy8gUHJldmVudCBvdmVybGF5IGNsb3NlXHJcbiAgICAgICAgICAgIG92ZXJsYXkucmVtb3ZlKCk7ICAvLyBSZW1vdmUgdGhlIG92ZXJsYXkgb24gY2xvc2VcclxuICAgICAgICAgICAgY3VycmVudE92ZXJsYXkgPSBudWxsOyAgLy8gQ2xlYXIgdGhlIGN1cnJlbnQgb3ZlcmxheSByZWZlcmVuY2VcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcm93MS5hcHBlbmRDaGlsZCh3b3JkKTtcclxuICAgICAgICByb3cxLmFwcGVuZENoaWxkKGNsb3NlSWNvbik7XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgc2Vjb25kIHJvdzogUGhvbmV0aWNzICsgU3BlYWtlciBpY29uXHJcbiAgICAgICAgY29uc3Qgcm93MiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHJvdzIuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcclxuICAgICAgICByb3cyLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ3NwYWNlLWJldHdlZW4nO1xyXG4gICAgICAgIHJvdzIuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xyXG4gICAgICAgIHJvdzIuc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnO1xyXG5cclxuICAgICAgICBjb25zdCBwaG9uZXRpYyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgICBwaG9uZXRpYy50ZXh0Q29udGVudCA9IChkYXRhWzBdLnBob25ldGljcyAmJiBkYXRhWzBdLnBob25ldGljc1swXSAmJiBkYXRhWzBdLnBob25ldGljc1swXS50ZXh0KSB8fCAnTm9uZSc7ICAvLyBQaG9uZXRpY3Mgb2YgdGhlIHdvcmRcclxuICAgICAgICBwaG9uZXRpYy5zdHlsZS5mb250U2l6ZSA9ICcxNHB4JztcclxuICAgICAgICBwaG9uZXRpYy5zdHlsZS5jb2xvciA9ICcjZGRkJztcclxuXHJcbiAgICAgICAgcm93Mi5hcHBlbmRDaGlsZChwaG9uZXRpYyk7XHJcblxyXG4gICAgICAgIGlmIChkYXRhWzBdLnBob25ldGljcyAmJiBkYXRhWzBdLnBob25ldGljc1swXSAmJiBkYXRhWzBdLnBob25ldGljc1swXS5hdWRpbykge1xyXG4gICAgICAgICAgICBjb25zdCBzcGVha2VyQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7IC8vIENyZWF0ZSBhIGJ1dHRvbiBlbGVtZW50XHJcbiAgICAgICAgICAgIHNwZWFrZXJCdXR0b24udGV4dENvbnRlbnQgPSAn8J+Uiic7IC8vIFNwZWFrZXIgaWNvbiBmb3IgcHJvbnVuY2lhdGlvblxyXG4gICAgICAgICAgICBzcGVha2VyQnV0dG9uLnN0eWxlLmZvbnRTaXplID0gJzE4cHgnO1xyXG4gICAgICAgICAgICBzcGVha2VyQnV0dG9uLnN0eWxlLmN1cnNvciA9ICdwb2ludGVyJztcclxuICAgICAgICAgICAgc3BlYWtlckJ1dHRvbi5zdHlsZS5ib3JkZXIgPSAnbm9uZSc7IC8vIE9wdGlvbmFsOiBTdHlsZSB0aGUgYnV0dG9uIHRvIGxvb2sgbWluaW1hbFxyXG4gICAgICAgICAgICBzcGVha2VyQnV0dG9uLnN0eWxlLmJhY2tncm91bmQgPSAndHJhbnNwYXJlbnQnOyAvLyBPcHRpb25hbDogVHJhbnNwYXJlbnQgYmFja2dyb3VuZFxyXG4gICAgICAgICAgICBzcGVha2VyQnV0dG9uLnN0eWxlLnBhZGRpbmcgPSAnMCc7IC8vIE9wdGlvbmFsOiBSZW1vdmUgcGFkZGluZyBmb3IgaWNvbi1vbmx5IGJ1dHRvblxyXG4gICAgICAgICAgICBzcGVha2VyQnV0dG9uLnN0eWxlLm91dGxpbmUgPSAnbm9uZSc7IC8vIE9wdGlvbmFsOiBSZW1vdmUgZm9jdXMgb3V0bGluZVxyXG4gICAgICAgICAgICBzcGVha2VyQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdQbGF5IHByb251bmNpYXRpb24nKTsgLy8gQWNjZXNzaWJpbGl0eSBlbmhhbmNlbWVudFxyXG5cclxuICAgICAgICAgICAgc3BlYWtlckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7IC8vIFN0b3AgZXZlbnQgcHJvcGFnYXRpb24gdG8gcHJldmVudCBvdmVybGF5IGZyb20gY2xvc2luZ1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGFbMF0ucGhvbmV0aWNzICYmIGRhdGFbMF0ucGhvbmV0aWNzWzBdICYmIGRhdGFbMF0ucGhvbmV0aWNzWzBdLmF1ZGlvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXVkaW8gPSBuZXcgQXVkaW8oZGF0YVswXS5waG9uZXRpY3NbMF0uYXVkaW8pOyAvLyBQbGF5IGF1ZGlvIHByb251bmNpYXRpb25cclxuICAgICAgICAgICAgICAgICAgICBhdWRpby5wbGF5KCkuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBwbGF5aW5nIGF1ZGlvOlwiLCBlcnJvcik7IC8vIEhhbmRsZSBwb3RlbnRpYWwgZXJyb3JzXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkF1ZGlvIG5vdCBhdmFpbGFibGUgZm9yIHByb251bmNpYXRpb24uXCIpOyAvLyBIYW5kbGUgY2FzZXMgd2l0aCBubyBhdWRpb1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJvdzIuYXBwZW5kQ2hpbGQoc3BlYWtlckJ1dHRvbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDcmVhdGUgdGhlIHRoaXJkIHJvdzogTWVhbmluZ1xyXG4gICAgICAgIGNvbnN0IHJvdzMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICByb3czLnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JztcclxuICAgICAgICBjb25zdCBtZWFuaW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgICAgIG1lYW5pbmcudGV4dENvbnRlbnQgPSAoZGF0YVswXS5tZWFuaW5ncyAmJiBkYXRhWzBdLm1lYW5pbmdzWzBdLmRlZmluaXRpb25zWzBdLmRlZmluaXRpb24pIHx8ICdObyBtZWFuaW5nIGZvdW5kJzsgIC8vIFRoZSBtZWFuaW5nIG9mIHRoZSB3b3JkXHJcbiAgICAgICAgbWVhbmluZy5zdHlsZS5mb250U2l6ZSA9ICcxNnB4JztcclxuICAgICAgICBtZWFuaW5nLnN0eWxlLmNvbG9yID0gJyNkZGQnO1xyXG4gICAgICAgIG1lYW5pbmcuc3R5bGUubGluZUhlaWdodCA9ICcxLjcnO1xyXG5cclxuICAgICAgICByb3czLmFwcGVuZENoaWxkKG1lYW5pbmcpO1xyXG5cclxuICAgICAgICAvLyBBcHBlbmQgdGhlIHJvd3MgdG8gdGhlIG92ZXJsYXlcclxuICAgICAgICBvdmVybGF5LmFwcGVuZENoaWxkKHJvdzEpO1xyXG4gICAgICAgIG92ZXJsYXkuYXBwZW5kQ2hpbGQocm93Mik7XHJcbiAgICAgICAgb3ZlcmxheS5hcHBlbmRDaGlsZChyb3czKTtcclxuXHJcbiAgICAgICAgLy8gQXBwZW5kIHRoZSBvdmVybGF5IHRvIHRoZSBkb2N1bWVudCBib2R5XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvdmVybGF5KTtcclxuXHJcbiAgICAgICAgLy8gU3RvcmUgdGhlIGN1cnJlbnQgb3ZlcmxheSBmb3IgZnV0dXJlIHJlZmVyZW5jZVxyXG4gICAgICAgIGN1cnJlbnRPdmVybGF5ID0gb3ZlcmxheTtcclxuICAgIH1cclxufSkoKTtcclxuIl0sIm5hbWVzIjpbImN1cnJlbnRPdmVybGF5IiwiZGlzcGxheU92ZXJsYXkiLCJwb3NpdGlvbiIsImRhdGEiLCJ3b3JkIiwicGhvbmV0aWNzIiwidGV4dCIsImF1ZGlvIiwibWVhbmluZ3MiLCJkZWZpbml0aW9ucyIsImRlZmluaXRpb24iLCJvdmVybGF5IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic3R5bGUiLCJsZWZ0IiwidG9wIiwiYmFja2dyb3VuZENvbG9yIiwiY29sb3IiLCJwYWRkaW5nIiwiYm9yZGVyUmFkaXVzIiwiekluZGV4Iiwid2lkdGgiLCJtYXhXaWR0aCIsImJveFNoYWRvdyIsInJvdzEiLCJkaXNwbGF5IiwianVzdGlmeUNvbnRlbnQiLCJhbGlnbkl0ZW1zIiwidGV4dENvbnRlbnQiLCJmb250U2l6ZSIsImZvbnRXZWlnaHQiLCJjbG9zZUljb24iLCJjdXJzb3IiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJzdG9wUHJvcGFnYXRpb24iLCJyZW1vdmUiLCJhcHBlbmRDaGlsZCIsInJvdzIiLCJtYXJnaW5Ub3AiLCJwaG9uZXRpYyIsInNwZWFrZXJCdXR0b24iLCJib3JkZXIiLCJiYWNrZ3JvdW5kIiwib3V0bGluZSIsInNldEF0dHJpYnV0ZSIsIkF1ZGlvIiwicGxheSIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwid2FybiIsInJvdzMiLCJtZWFuaW5nIiwibGluZUhlaWdodCIsImJvZHkiLCJzZWxlY3Rpb24iLCJzZWxlY3RlZFRleHQiLCJ3aW5kb3ciLCJnZXRTZWxlY3Rpb24iLCJ0b1N0cmluZyIsInRyaW0iLCJsb2ciLCJyZWN0IiwiZ2V0UmFuZ2VBdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInNjcm9sbFkiLCJzY3JvbGxYIiwiY2hyb21lIiwicnVudGltZSIsInNlbmRNZXNzYWdlIiwiYWN0aW9uIiwicmVzcG9uc2UiLCJsYXN0RXJyb3IiLCJ0eXBlIiwibm90RmV0Y2hlZERhdGEiXSwic291cmNlUm9vdCI6IiJ9